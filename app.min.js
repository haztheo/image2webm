function readURL(e){if(e.files&&e.files[0]){var t=new FileReader;t.onload=function(e){var n=t.result;console.log("url : ",n),makeVideo(n)},console.log(e.files[0]);var n=e.files[0].name.split(".")[0]+".webm";document.getElementById("download").setAttribute("download",n),t.readAsDataURL(e.files[0])}}function returnHeightWidth(e,t){var n=e.width,o=e.height;if(isChrome)t(n,o);else{console.log("The width of the image is "+n+"px."),console.log("The height of the image is "+o+"px.");if(o>n){if(o>1280){var a=1280/o;n=Math.floor(a*n),o=1280}}else if(n>1280){a=1280/n;o=Math.floor(o*a),n=1280}t(n,o)}}function toggleCompression(){compress_stuff=!compress_stuff}function grabImageVideo(e,t){var n=new Image;n.onload=function(){returnHeightWidth(n,function(e,o){n.width=e,n.height=o;var a=document.getElementById("canvas");a.width=e,a.height=o;var i=a.getContext("2d");if(i.fillStyle="black",i.fillRect(0,0,a.width,a.height),i.globalAlpha=1,i.drawImage(n,0,0,a.width,a.height),compress_stuff){var d=a.toDataURL("image/jpeg",.1),m=new Image;m.onload=function(){i.drawImage(m,0,0,a.width,a.height),t(i,a)},m.src=d}else t(i,a)})},n.src=e}function grabFrame(e,t){grabImageVideo(e,function(e,n){var o=isChrome?whammy_:whammy_cross,a=n.width,i=n.height;if(isChrome)o.add(e,1e3),o.add(e,1e3),o.add(e,1e3);else{o.setFrameRate(framerate);var d=e.getImageData(0,0,a,i).data;o.addFrame(d,a,i,3)}t()})}function makeVideo(e){isChrome?whammy_=new Whammy.Video:((whammy_cross=new WhammyCrs).reset(),whammy_cross.progress=function(e){console.log("progress : ",e)}),grabFrame(e,function(){isChrome?(console.log("can handle web p"),whammy_.compile(void 0,function(e){console.log("videoBlob : ",e);var t=window.URL.createObjectURL(e);document.getElementById("awesome").src=t,document.getElementById("download").style.display="",document.getElementById("donut").style.display="none",document.getElementById("download").href=t})):(console.warn("cannot handle web p"),whammy_cross.encodeWEBM(function(e){var t=window.URL.createObjectURL(e);document.getElementById("awesome").src=t,document.getElementById("download").style.display="",document.getElementById("donut").style.display="none",document.getElementById("download").href=t}))})}!function(){var e=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;window.requestAnimationFrame=e}();var fbutton=document.getElementById("fbutton"),files=document.getElementById("filesinput");fbutton.addEventListener("click",function(){document.getElementById("filesinput").click()},!1),files.addEventListener("change",function(e){document.getElementById("awesome").src="",document.getElementById("download").style.display="none",document.getElementById("download").href="",filesarr=e.target.files,document.getElementById("donut").style.display="inline-block",readURL(e.target)},!1);var compress_stuff=!1,whammy_cross=null,whammy_=null,framerate=1,frames=[],webpUrlRegex=/^data:image\/webp;base64,/gi,isChrome=webpUrlRegex.test(document.createElement("canvas").toDataURL("image/webp"));