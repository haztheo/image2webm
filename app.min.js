function readURL(a){if(a.files&&a.files[0]){var b=new FileReader;b.onload=function(){var e=b.result;console.log("url : ",e),makeVideo(e)},console.log(a.files[0]);var e=a.files[0].name.split(".")[0]+".webm";document.getElementById("download").setAttribute("download",e),b.readAsDataURL(a.files[0])}}function returnHeightWidth(a,b){var e=a.width,d=a.height;console.log("The width of the image is "+e+"px."),console.log("The height of the image is "+d+"px.");var c=d>e;if(c){if(d>1280){var i=1280/d;e=Math.floor(i*e),d=1280}}else if(e>1280){var i=1280/e;d=Math.floor(d*i),e=1280}b(e,d)}function toggleCompression(){compress_stuff=!compress_stuff}function grabImageVideo(a,b){var e=new Image;e.onload=function(){returnHeightWidth(e,function(a,d){e.width=a,e.height=d;var c=document.getElementById("canvas");c.width=a,c.height=d;var i=c.getContext("2d");if(i.globalAlpha=1,i.drawImage(e,0,0,c.width,c.height),compress_stuff){var f=c.toDataURL("image/jpeg",.1),t=new Image;t.onload=function(){i.drawImage(t,0,0,c.width,c.height),b(i,c)},t.src=f}else b(i,c)})},e.src=a}function grabFrame(a,b){grabImageVideo(a,function(a,e){var d=isChrome?whammy_:whammy_cross,c=e.width,i=e.height;if(isChrome)d.add(a,1e3),d.add(a,1e3),d.add(a,1e3);else{d.setFrameRate(framerate);var f=a.getImageData(0,0,c,i).data;d.addFrame(f,c,i,3)}b()})}function makeVideo(a){isChrome?whammy_=new Whammy.Video:(whammy_cross=new WhammyCrs,whammy_cross.reset(),whammy_cross.progress=function(a){console.log("progress : ",a)}),grabFrame(a,function(){isChrome?(console.log("can handle web p"),whammy_.compile(void 0,function(a){console.log("videoBlob : ",a);var b=window.URL.createObjectURL(a);document.getElementById("awesome").src=b,document.getElementById("download").style.display="",document.getElementById("donut").style.display="none",document.getElementById("download").href=b})):(console.warn("cannot handle web p"),whammy_cross.encodeWEBM(function(a){var b=window.URL.createObjectURL(a);document.getElementById("awesome").src=b,document.getElementById("download").style.display="",document.getElementById("donut").style.display="none",document.getElementById("download").href=b}))})}!function(){var a=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;window.requestAnimationFrame=a}();var fbutton=document.getElementById("fbutton"),files=document.getElementById("filesinput");fbutton.addEventListener("click",function(){document.getElementById("filesinput").click()},!1),files.addEventListener("change",function(a){document.getElementById("awesome").src="",document.getElementById("download").style.display="none",document.getElementById("download").href="",filesarr=a.target.files,document.getElementById("donut").style.display="inline-block",readURL(a.target)},!1);var compress_stuff=!1,whammy_cross=null,whammy_=null,framerate=1,frames=[],webpUrlRegex=/^data:image\/webp;base64,/gi,isChrome=webpUrlRegex.test(document.createElement("canvas").toDataURL("image/webp"));